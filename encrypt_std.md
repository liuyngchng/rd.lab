GB/T 38629-2020		信息安全技术 签名验签服务器技术规范
GB/T 17901.1-2020	信息技术 安全技术 密钥管理 第1部分：框架C004A





GB/T 35276-2017  信息安全技术 SM2密码算法使用规范

GB/T 38635.1-2020  信息安全技术 SM9标识密码算法 第1部分：总则

GB/T 39786-2021		信息安全技术 信息系统密码应用基本要求
GB/T 22239-2019		信息安全技术 网络安全等级保护基本要求
GB/T 37092-2018		信息安全技术 密码模块安全要求
GB/T 32905-2016		信息安全技术 SM3密码杂凑算法
GB/T 35276-2017		信息安全技术 SM2密码算法使用规范
GB/T 32907-2016		信息安全技术 SM4分组密码算法

密钥管理系统的功能主要包括密钥生成、密钥注入、密钥备份、密钥恢复、密钥更新、密钥导出和服务，以及密钥的销毁等。

（1）**密钥生成。**通过输入一到多组的密钥种子，按照可再现或不可再现的模式生成所需要的密钥。一般采用不可再现模式作为密钥生成的方式，以增强系统的安全性。

（2）**密钥注入、备份、恢复**。这些功能主要通过密钥卡或硬件加密机等工具来完成，偶尔也采用密码信封的形式。

（3）**密钥更新、导出**。当系统采用密钥种子作为密钥的恢复手段时，只能采用可再现模式。而密钥导出往往伴随着密钥分散（例如，密码办的密钥为K1，发到各个省份的密钥为K2(根据K1和省份信息生成)，发到各个市的密钥为K3(根据K2和各个市的信息生成)，这就是密钥逐级分散的过程），这是对称密钥安全体系中一个很重要的特性。

（4）**密钥服务**。包括对不同机构或人员对不同密钥的生成、更新、使用等操作拥有不同的权限，进行严格的权限控制。

（5）**密钥销毁**。为了保障信息系统的保密性、完整性和可用性，对于不再使用的密钥需要进行销毁。

总之，密钥管理系统是一种集成了上述功能的系统，旨在确保密钥的安全性和完整性。

密钥管理的体系结构可以包括多个层次，例如根密钥、密钥加密密钥和工作密钥等。这些不同层次的密钥可以采用分层的密钥结构来进行管理，以增强密钥的安全性和可管理性。

在密钥分层管理机制中，下层密钥为上层密钥提供加密保护，例如，工作密钥可以对本地保存的敏感数据和需要在不安全信道上传输的数据提供机密性、完整性保护，并且还可以提供认证和签名等密码学服务。而密钥加密密钥则对工作密钥提供机密性保护。

此外，密钥管理系统还需要具备根密钥的备份机制和密钥一旦泄露后的密钥紧急更新机制。在应用场景复杂的情况下，推荐使用三层管理结构，至少选择两层结构进行管理。

总之，密钥管理的体系结构应该能够满足不同层次的安全需求，并且需要具备可管理性和可维护性，以确保密钥的安全性和完整性。

在密钥分层管理机制中，加密保护是通过对上层密钥进行加密来保护下层密钥的过程。具体来说，根密钥位于密钥管理分层结构的最底端，用于对上层密钥（如密钥加密密钥）的机密性进行保护。而密钥加密密钥则对工作密钥提供机密性保护，其自身受到根密钥的保护。

在实际应用中，可以采用不同的加密算法和密钥长度来满足不同的安全需求。例如，在较为简单、安全等级要求不高的密码应用系统中，可以采用两层加密结构，即根密钥和工作密钥。在这种情况下，根密钥可以采用较长的密钥长度和复杂的加密算法来保护工作密钥，而工作密钥则可以采用较短的密钥长度和简单的加密算法来保护实际数据。

当根密钥丢失或泄露时，需要重新生成一个新的根密钥，并对所有受影响的下层密钥进行重新加密和更新。此外，如果工作密钥丢失或泄露，也需要对相应的数据进行重新加密和保护。因此，密钥分层管理机制需要建立完善的密钥管理计划和流程，以确保密钥的安全性和可管理性。

总之，密钥分层管理机制中的加密保护是通过利用不同层次之间的密钥关系和加密算法来实现的，可以增强密钥的安全性和可管理性。

密钥分层管理机制中的访问控制过程是为了确保只有经过授权的人员能够访问和使用密钥。这个过程可以通过采用访问控制策略和授权机制来实现。

具体来说，访问控制策略可以根据不同的安全需求和应用场景来确定，例如根据用户的身份、角色、部门等属性进行授权。在密钥分层管理机制中，不同层次的密钥可以设置不同的访问控制策略，例如，根密钥可以由最高级别的管理员进行管理和访问，而工作密钥则可以由普通用户进行使用和访问。

在实现访问控制过程中，可以采用基于角色的访问控制（RBAC）或基于属性的访问控制（ABAC）等模型来对用户进行授权。其中，RBAC是基于用户的角色来赋予其访问权限，而ABAC则是根据用户的属性（如身份、部门、时间等）来控制其访问权限。

在密钥分层管理机制中，对于不同层次的密钥，可以根据实际情况采用不同的访问控制模型。例如，对于根密钥的访问权限可以由最高级别的管理员进行控制，而对于工作密钥的访问权限则可以由普通用户进行控制。

总之，密钥分层管理机制中的访问控制过程是通过对不同层次的密钥进行授权和访问控制来实现的，可以确保只有经过授权的人员能够访问和使用密钥，增强密钥的安全性和可管理性。









